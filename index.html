<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Syafiq Hakimi | Links</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div class="container">
        <div class="header">
            <img id="imgLogo" src="" alt="Profile" class="profile-pic" onerror="this.src='https://ui-avatars.com/api/?name=Syafiq+Hakimi&background=0984e3&color=fff&size=128'">
            <h1 id="txtName">Loading...</h1>
            <p class="subtitle" id="txtSub">...</p>
        </div>

        <div class="links-container" id="linkContainer"></div>

        <div class="socials-container" id="socialContainer">
            </div>

        <div class="footer">
            &copy; 2026 Syafiq Hakimi
        </div>
    </div>

    <div id="passModal" class="modal-overlay">
        <div class="modal-box">
            <h3><i class="fa-solid fa-shield-halved" style="color:#0984e3; font-size:2rem; margin-bottom:10px;"></i><br>Akses Terhad</h3>
            <p>Sila masukkan kunci akses.</p>
            <input type="password" id="inputPass" class="pass-input" placeholder="****">
            <div class="modal-btns">
                <button class="btn-cancel" onclick="closeModal()">Batal</button>
                <button class="btn-submit" onclick="submitPass()">Buka</button>
            </div>
        </div>
    </div>

    <script type="module">
        // Import SocialList sekali
        import { profileData, linkList, socialList } from './data.js';

        // 1. Profile
        document.getElementById('txtName').innerText = profileData.name;
        document.getElementById('txtSub').innerText = profileData.subtitle;
        if(profileData.logo) document.getElementById('imgLogo').src = profileData.logo;

        // Variables
        let currentEncryptedUrl = "";

        // Global Window Functions (Sebab type=module)
        window.closeModal = () => {
            document.getElementById('passModal').style.display = 'none';
            document.getElementById('inputPass').value = "";
        };

        window.submitPass = () => {
            const userPass = document.getElementById('inputPass').value;
            const btn = document.querySelector('.btn-submit');
            const originalText = btn.innerText;
            btn.innerText = "...";

            setTimeout(() => {
                try {
                    const bytes = CryptoJS.AES.decrypt(currentEncryptedUrl, userPass);
                    const originalUrl = bytes.toString(CryptoJS.enc.Utf8);
                    if (originalUrl.startsWith("http")) {
                        window.open(originalUrl, "_blank");
                        closeModal();
                    } else { throw new Error(); }
                } catch (e) {
                    alert("Kunci Salah!");
                    document.getElementById('inputPass').value = "";
                }
                btn.innerText = originalText;
            }, 300);
        };

        // 2. Render MAIN Links
        const container = document.getElementById('linkContainer');
        linkList.forEach(link => {
            const btn = document.createElement('div');
            btn.className = "link-card";
            
            const iconClass = link.icon || 'fa-solid fa-link';
            const lockIcon = link.encryptedUrl ? 
                '<i class="fa-solid fa-lock" style="font-size:0.8rem; margin-left:auto; color:#666;"></i>' : 
                '<i class="fa-solid fa-chevron-right" style="font-size:0.8rem; margin-left:auto; color:#333;"></i>';

            btn.innerHTML = `<div class="link-icon"><i class="${iconClass}"></i></div><span>${link.title}</span>${lockIcon}`;

            btn.onclick = () => {
                if (link.encryptedUrl) {
                    currentEncryptedUrl = link.encryptedUrl;
                    document.getElementById('passModal').style.display = 'flex';
                    document.getElementById('inputPass').focus();
                } else { window.open(link.url, "_blank"); }
            };
            container.appendChild(btn);
        });

        // 3. Render SOCIAL Links (Bahagian Bawah)
        const socialCont = document.getElementById('socialContainer');
        socialList.forEach(soc => {
            const a = document.createElement('a');
            a.href = soc.url;
            a.target = "_blank";
            a.className = "social-btn";
            a.innerHTML = `<i class="${soc.icon}"></i>`;
            socialCont.appendChild(a);
        });

        document.getElementById('inputPass').addEventListener("keypress", (e) => {
            if(e.key === "Enter") { e.preventDefault(); submitPass(); }
        });
    </script>
</body>
</html>